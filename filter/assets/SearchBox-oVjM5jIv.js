import{p as ue,am as Pe,k as oe,an as Re,e as D,ai as E,af as le,f as C,g as B,O as te,aO as De,u as ie,a as s,F as q,a6 as T,aP as _e,h as Ae,aQ as Me,ag as Te,aR as Ee,m as Be,o as Oe,c as Ke,w as Q,Q as W,Y,ao as Le,ap as Ne}from"./index-CBct6GD7.js";import{m as Ue,u as qe,V as G,f as se,b as $e,c as je}from"./VTextField-DYh2cG8J.js";import{m as ze,b as He,u as Qe,c as We,d as Ye,a as Ge}from"./filter-BuOHV4p0.js";import{w as Je,l as Xe,V as ae,a as Ze}from"./VImg-CstJdRdJ.js";import{u as el,t as O,a as ll,b as ne}from"./VList-pLf4mgAz.js";import{V as tl}from"./VMenu-CINY5IPK.js";import{V as al}from"./VAvatar-_eqAo5IC.js";import{V as nl}from"./VChip-CT3pkPar.js";import{V as ul}from"./VBtn-CLsa8P2Z.js";function ol(e,g,w){if(g==null)return e;if(Array.isArray(g))throw new Error("Multiple matches is not implemented");return typeof g=="number"&&~g?s(q,null,[s("span",{class:"v-combobox__unmask"},[e.substr(0,g)]),s("span",{class:"v-combobox__mask"},[e.substr(g,w)]),s("span",{class:"v-combobox__unmask"},[e.substr(g+w)])]):e}const il=ue({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...ze({filterKeys:["title"]}),...He({hideNoData:!0,returnObject:!0}),...Pe(Ue({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Je({transition:!1})},"VCombobox"),sl=oe()({name:"VCombobox",props:il(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,g){var X;let{emit:w,slots:n}=g;const{t:S}=Re(),d=D(),f=E(!1),m=E(!0),V=E(!1),x=D(),b=D(),y=le(e,"menu"),o=C({get:()=>y.value,set:l=>{var a;y.value&&!l&&((a=x.value)!=null&&a.ΨopenChildren)||(y.value=l)}}),r=E(-1);let $=!1;const re=C(()=>{var l;return(l=d.value)==null?void 0:l.color}),J=C(()=>o.value?e.closeText:e.openText),{items:ce,transformIn:ve,transformOut:de}=el(e),{textColorClasses:fe,textColorStyles:me}=Xe(re),u=le(e,"modelValue",[],l=>ve(Te(l)),l=>{const a=de(l);return e.multiple?a:a[0]??null}),M=qe(),K=C(()=>!!(e.chips||n.chip)),I=C(()=>K.value||!!n.selection),P=E(!e.multiple&&!I.value?((X=u.value[0])==null?void 0:X.title)??"":""),v=C({get:()=>P.value,set:l=>{var a;if(P.value=l??"",!e.multiple&&!I.value&&(u.value=[O(e,l)]),l&&e.multiple&&((a=e.delimiters)!=null&&a.length)){const c=l.split(new RegExp(`(?:${e.delimiters.join("|")})+`));c.length>1&&(c.forEach(t=>{t=t.trim(),t&&F(O(e,t))}),P.value="")}l||(r.value=-1),m.value=!l}}),be=C(()=>typeof e.counterValue=="function"?e.counterValue(u.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?u.value.length:v.value.length);B(P,l=>{$?te(()=>$=!1):f.value&&!o.value&&(o.value=!0),w("update:search",l)}),B(u,l=>{var a;!e.multiple&&!I.value&&(P.value=((a=l[0])==null?void 0:a.title)??"")});const{filteredItems:L,getMatches:he}=Qe(e,ce,()=>m.value?"":v.value),R=C(()=>e.hideSelected?L.value.filter(l=>!u.value.some(a=>a.value===l.value)):L.value),ge=C(()=>u.value.map(l=>l.value)),j=C(()=>{var a;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&v.value===((a=R.value[0])==null?void 0:a.title))&&R.value.length>0&&!m.value&&!V.value}),z=C(()=>e.hideNoData&&!R.value.length||e.readonly||(M==null?void 0:M.isReadonly.value)),H=D(),{onListScroll:ye,onListKeydown:pe}=We(H,d);function Ve(l){$=!0,e.openOnClear&&(o.value=!0)}function xe(){z.value||(o.value=!0)}function ke(l){z.value||(f.value&&(l.preventDefault(),l.stopPropagation()),o.value=!o.value)}function we(l){var t;if(Ee(l)||e.readonly||M!=null&&M.isReadonly.value)return;const a=d.value.selectionStart,c=u.value.length;if((r.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(o.value=!0),["Escape"].includes(l.key)&&(o.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(j.value&&["Enter","Tab"].includes(l.key)&&!u.value.some(i=>{let{value:k}=i;return k===R.value[0].value})&&F(L.value[0]),m.value=!0),l.key==="ArrowDown"&&j.value&&((t=H.value)==null||t.focus("next")),l.key==="Enter"&&v.value&&(F(O(e,v.value)),I.value&&(P.value="")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&I.value&&u.value.length>0&&!v.value)return F(u.value[0],!1);if(~r.value){const i=r.value;F(u.value[r.value],!1),r.value=i>=c-1?c-2:i}else l.key==="Backspace"&&!v.value&&(r.value=c-1)}if(e.multiple){if(l.key==="ArrowLeft"){if(r.value<0&&a>0)return;const i=r.value>-1?r.value-1:c-1;u.value[i]?r.value=i:(r.value=-1,d.value.setSelectionRange(v.value.length,v.value.length))}if(l.key==="ArrowRight"){if(r.value<0)return;const i=r.value+1;u.value[i]?r.value=i:(r.value=-1,d.value.setSelectionRange(0,0))}}}function Ce(){var l;f.value&&(m.value=!0,(l=d.value)==null||l.focus())}function F(l){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const c=u.value.findIndex(i=>e.valueComparator(i.value,l.value)),t=a??!~c;if(~c){const i=t?[...u.value,l]:[...u.value];i.splice(c,1),u.value=i}else t&&(u.value=[...u.value,l]);e.clearOnSelect&&(v.value="")}else{const c=a!==!1;u.value=c?[l]:[],P.value=c&&!I.value?l.title:"",te(()=>{o.value=!1,m.value=!0})}}function Se(l){f.value=!0,setTimeout(()=>{V.value=!0})}function Fe(l){V.value=!1}function Ie(l){(l==null||l===""&&!e.multiple&&!I.value)&&(u.value=[])}return B(f,(l,a)=>{if(!(l||l===a)&&(r.value=-1,o.value=!1,v.value)){if(e.multiple){F(O(e,v.value));return}if(!I.value)return;u.value.some(c=>{let{title:t}=c;return t===v.value})?P.value="":F(O(e,v.value))}}),B(o,()=>{if(!e.hideSelected&&o.value&&u.value.length){const l=R.value.findIndex(a=>u.value.some(c=>e.valueComparator(c.value,a.value)));De&&window.requestAnimationFrame(()=>{var a;l>=0&&((a=b.value)==null||a.scrollToIndex(l))})}}),B(()=>e.items,(l,a)=>{o.value||f.value&&!a.length&&l.length&&(o.value=!0)}),ie(()=>{const l=!!(!e.hideNoData||R.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),a=u.value.length>0,c=G.filterProps(e);return s(G,T({ref:d},c,{modelValue:v.value,"onUpdate:modelValue":[t=>v.value=t,Ie],focused:f.value,"onUpdate:focused":t=>f.value=t,validationValue:u.externalValue,counterValue:be.value,dirty:a,class:["v-combobox",{"v-combobox--active-menu":o.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!I.value,"v-combobox--selecting-index":r.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:e.readonly,placeholder:a?void 0:e.placeholder,"onClick:clear":Ve,"onMousedown:control":xe,onKeydown:we}),{...n,default:()=>s(q,null,[s(tl,T({ref:x,modelValue:o.value,"onUpdate:modelValue":t=>o.value=t,activator:"parent",contentClass:"v-combobox__content",disabled:z.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Ce},e.menuProps),{default:()=>[l&&s(ll,T({ref:H,selected:ge.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:t=>t.preventDefault(),onKeydown:pe,onFocusin:Se,onFocusout:Fe,onScrollPassive:ye,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var t,i,k;return[(t=n["prepend-item"])==null?void 0:t.call(n),!R.value.length&&!e.hideNoData&&(((i=n["no-data"])==null?void 0:i.call(n))??s(ne,{title:S(e.noDataText)},null)),s(Ye,{ref:b,renderless:!0,items:R.value},{default:_=>{var ee;let{item:h,index:A,itemRef:p}=_;const Z=T(h.props,{ref:p,key:A,active:j.value&&A===0?!0:void 0,onClick:()=>F(h,null)});return((ee=n.item)==null?void 0:ee.call(n,{item:h,index:A,props:Z}))??s(ne,T(Z,{role:"option"}),{prepend:N=>{let{isSelected:U}=N;return s(q,null,[e.multiple&&!e.hideSelected?s(Ge,{key:h.value,modelValue:U,ripple:!1,tabindex:"-1"},null):void 0,h.props.prependAvatar&&s(al,{image:h.props.prependAvatar},null),h.props.prependIcon&&s(ae,{icon:h.props.prependIcon},null)])},title:()=>{var N,U;return m.value?h.title:ol(h.title,(N=he(h))==null?void 0:N.title,((U=v.value)==null?void 0:U.length)??0)}})}}),(k=n["append-item"])==null?void 0:k.call(n)]}})]}),u.value.map((t,i)=>{function k(p){p.stopPropagation(),p.preventDefault(),F(t,!1)}const _={"onClick:close":k,onKeydown(p){p.key!=="Enter"&&p.key!==" "||(p.preventDefault(),p.stopPropagation(),k(p))},onMousedown(p){p.preventDefault(),p.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},h=K.value?!!n.chip:!!n.selection,A=h?_e(K.value?n.chip({item:t,index:i,props:_}):n.selection({item:t,index:i})):void 0;if(!(h&&!A))return s("div",{key:t.value,class:["v-combobox__selection",i===r.value&&["v-combobox__selection--selected",fe.value]],style:i===r.value?me.value:{}},[K.value?n.chip?s(Ze,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:t.title}}},{default:()=>[A]}):s(nl,T({key:"chip",closable:e.closableChips,size:"small",text:t.title,disabled:t.props.disabled},_),null):A??s("span",{class:"v-combobox__selection-text"},[t.title,e.multiple&&i<u.value.length-1&&s("span",{class:"v-combobox__selection-comma"},[Ae(",")])])])})]),"append-inner":function(){var _;for(var t=arguments.length,i=new Array(t),k=0;k<t;k++)i[k]=arguments[k];return s(q,null,[(_=n["append-inner"])==null?void 0:_.call(n,...i),(!e.hideNoData||e.items.length)&&e.menuIcon?s(ae,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:ke,onClick:Me,"aria-label":S(J.value),title:S(J.value),tabindex:"-1"},null):void 0])}})}),se({isFocused:f,isPristine:m,menu:o,search:v,selectionIndex:r,filteredItems:L,select:F},d)}}),rl=ue({...Be(),...$e()},"VForm"),cl=oe()({name:"VForm",props:rl(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,g){let{slots:w,emit:n}=g;const S=je(e),d=D();function f(V){V.preventDefault(),S.reset()}function m(V){const x=V,b=S.validate();x.then=b.then.bind(b),x.catch=b.catch.bind(b),x.finally=b.finally.bind(b),n("submit",x),x.defaultPrevented||b.then(y=>{var r;let{valid:o}=y;o&&((r=d.value)==null||r.submit())}),x.preventDefault()}return ie(()=>{var V;return s("form",{ref:d,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:f,onSubmit:m},[(V=w.default)==null?void 0:V.call(w,S)])}),se(S,d)}}),Vl={__name:"SearchBox",props:{loading:{type:Boolean,default:!1},type:{type:String,default:"全部"},keywords:{type:String,default:""}},emits:["search"],setup(e,{emit:g}){const w=e,n=g,S=["全部","IMSI","应用","小程序","网站"],d=D(!1),f=D(w.type),m=D(w.keywords),V={required:b=>f.value=="IMSI"?/^\d{14,16}$/.test(b)||"请输入有效IMSI":!!b||"请输入搜索关键字"},x=()=>{d.value&&n("search",f.value,m.value)};return(b,y)=>(Oe(),Ke(cl,{modelValue:W(d),"onUpdate:modelValue":y[2]||(y[2]=o=>Y(d)?d.value=o:null)},{default:Q(()=>[s(G,{loading:e.loading,label:"请输入查询对象",modelValue:W(m),"onUpdate:modelValue":y[1]||(y[1]=o=>Y(m)?m.value=o:null),clearable:"","single-line":"",color:"primary",rules:[V.required],variant:"outlined",onKeyup:Le(x,["enter"])},{prepend:Q(()=>[s(sl,{modelValue:W(f),"onUpdate:modelValue":y[0]||(y[0]=o=>Y(f)?f.value=o:null),items:S,"hide-details":"",variant:"outlined",class:"w-30",color:"primary"},null,8,["modelValue"])]),"append-inner":Q(()=>[s(ul,{density:"comfortable",icon:"mdi-magnify",onClick:Ne(x,["stop"])})]),_:1},8,["loading","modelValue","rules"])]),_:1},8,["modelValue"]))}};export{Vl as _};
